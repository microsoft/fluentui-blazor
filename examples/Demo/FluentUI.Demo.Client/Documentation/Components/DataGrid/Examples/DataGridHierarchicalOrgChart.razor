@using FluentUI.Demo.SampleData
@using static FluentUI.Demo.SampleData.People

<FluentButton Appearance="ButtonAppearance.Primary" IconStart="@(ceoItem?.IsCollapsed == true ? new Icons.Regular.Size16.Add() : new Icons.Regular.Size16.Subtract())"
			  OnClick="@ToggleCEO">
	@(ceoItem?.IsCollapsed == true ? "Expand" : "Collapse") CEO
</FluentButton>

<FluentDataGrid Items="@items.Where(i => !i.IsHidden).AsQueryable()" ResizableColumns="true">
	<TemplateColumn Title="Name" HierarchicalToggle="true">
		@(context.Item.FirstName + " " + context.Item.LastName)
	</TemplateColumn>
	<PropertyColumn Title="Job Title" Property="@(i => i.Item.JobTitle)" />
	<PropertyColumn Title="Department" Property="@(i => i.Item.Department)" />
	<PropertyColumn Title="Location" Property="@(i => i.Item.Location)" />
</FluentDataGrid>

@code {
	private PersonGridItem? ceoItem;
	List<PersonGridItem> items = new();

	protected override void OnInitialized()
	{
		var allPeople = GeneratePersons(30).ToList();

		// Level 0: CEO/Manager
		var ceo = allPeople[0] with { FirstName = "Mads", LastName = "Torgersen", JobTitle = "CEO", Department = "Executive" };
		ceoItem = new PersonGridItem { Item = ceo };
		ceoItem.IsCollapsed = false;
		items.Add(ceoItem);

		// ... existing code ...
		for (int i = 1; i <= 3; i++)
		{
			var manager = allPeople[i] with { JobTitle = "Director", Department = "Engineering" };
			var managerItem = new PersonGridItem { Item = manager, Depth = 1, IsCollapsed = i == 2 ? false : true};
			ceoItem.Children.Add(managerItem);
			items.Add(managerItem);

			// Level 2: Employees
			for (int j = 0; j < 4; j++)
			{
				var employee = allPeople[4 + (i - 1) * 4 + j];
				var employeeItem = new PersonGridItem { Item = employee, Depth = 2, IsHidden = i== 2 ? false : true };
				managerItem.Children.Add(employeeItem);
				items.Add(employeeItem);
			}
		}
	}

	private async Task ToggleCEO()
	{
		if (ceoItem is not null)
		{
			ceoItem.IsCollapsed = !ceoItem.IsCollapsed;
		}
	}

	public class PersonGridItem : HierarchicalGridItem<Person, PersonGridItem>
	{
	}
}
