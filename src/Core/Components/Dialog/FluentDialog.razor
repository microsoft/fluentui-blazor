@namespace Microsoft.Fast.Components.FluentUI
@using Microsoft.AspNetCore.Components.Rendering
@inherits FluentComponentBase

<CascadingValue Value="this" IsFixed="true">
    <fluent-dialog @ref="Element"
                   id="@Id"
                   class="@ClassValue"
                   style="@StyleValue"
                   modal="@((Modal ?? _parameters.Modal).ToString()?.ToLower())"
                   hidden="@Hidden"
                   trap-focus="@((TrapFocus ?? _parameters.TrapFocus).ToString()?.ToLower())"
                   aria-describedby=@(_parameters.AriaDescribedby ?? AriaDescribedby)
                   aria-labelledby=@(_parameters.AriaLabelledby ?? AriaLabelledby)
                   aria-label=@(_parameters.AriaLabel ?? AriaLabel)
                   @attributes=@AdditionalAttributes>
        <FluentStack Orientation="Orientation.Vertical" Class="fluent-dialog-content" Style="height:100%;">
            @_renderDialogHeader
            <div class="fluent-dialog-body" nofooter="@(!HasButtons)" style="@(_parameters.DialogBodyStyle ?? null)">
                @if (Instance is null)
                {
                    @ChildContent
                }
                else
                {
                    <DynamicComponent Type="@Instance.ContentType" Parameters="Instance.GetParameterDictionary()" />
                }
            </div>
            @_renderDialogFooter
        </FluentStack>
    </fluent-dialog>
</CascadingValue>

@code {

    private void RenderHeaderContent(RenderTreeBuilder __builder)
    {
        @if (_parameters.ShowTitle && (_parameters.Title != null || _parameters.ShowDismiss))
        {
            <FluentDialogHeader Title="@_parameters.Title" ShowDismiss="@_parameters.ShowDismiss" />
        }
    }

    private void RenderFooterContent(RenderTreeBuilder __builder)
    {
        @if (HasButtons)
        {
            <FluentDialogFooter Alignment="@_parameters.Alignment"
                                PrimaryAction="@_parameters.PrimaryAction"
                                PrimaryActionEnabled="@_parameters.PrimaryActionEnabled"
                                SecondaryAction="@_parameters.SecondaryAction"
                                SecondaryActionEnabled="@_parameters.SecondaryActionEnabled" />

        }
    }
}