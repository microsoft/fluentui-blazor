@namespace Microsoft.FluentUI.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Rendering;
@using Microsoft.FluentUI.AspNetCore.Components.Extensions
@inherits FluentComponentBase

<AddTag Name="span" TagWhen="@(() => LoadingOverlay)" class="@ClassValue" style="@StyleValue">
    <fluent-button class="@(LoadingOverlay ? null : ClassValue)"
                   style="@(LoadingOverlay ? null : StyleValue)"
                   autofocus="@AutoFocus"
                   form="@FormId"
                   formaction="@FormAction"
                   formenctype="@FormEncType"
                   formmethod="@FormMethod"
                   formnovalidate="@FormNoValidate"
                   formtarget="@FormTarget"
                   type="@(Type == ButtonType.Button ? null : Type.ToAttributeValue())"
                   shape="@(Shape == ButtonShape.Rounded ? null : Shape.ToAttributeValue())"
                   size="@(Size == ButtonSize.Medium ? null : Size.ToAttributeValue())"
                   id="@Id"
                   value="@Value"
                   icon-only="@(ChildContent is null)"
                   disabled="@(Disabled || Loading)"
                   disabled-focusable="@(DisabledFocusable || Loading)"
                   name="@Name"
                   required="@Required"
                   aria-label="@Title"
                   title="@Title"
                   appearance="@(Appearance == ButtonAppearance.Default ? null : Appearance.ToAttributeValue())"
                   @onclick="@OnClickHandlerAsync"
                   @attributes="AdditionalAttributes">
        @if (IconStart != null)
        {
            if (Loading)
            {
                <fluent-spinner size="tiny" slot="@(ChildContent is not null ? "start" : null)" style="@RingStyle(IconStart)" />
            }
            else
            {
                if (ChildContent is null)
                {
                    <FluentIcon Value="@IconStart" />
                }
                else
                {
                    <FluentIcon Value="@IconStart" Slot="start" />
                }
            }
        }
        @ChildContent
        @if (IconEnd != null)
        {
            if (Loading && IconStart == null)
            {
                <fluent-spinner size="tiny" slot="@(ChildContent != null ? "end" : null)" style="@RingStyle(IconEnd)" />
            }
            else
            {
                if (ChildContent is null)
                {
                    <FluentIcon Value="@IconEnd" />
                }
                else
                {
                    <FluentIcon Value="@IconEnd" Slot="end" />
                }
            }
        }
    </fluent-button>
    @if (LoadingOverlay)
    {
        <fluent-spinner size="tiny" />
    }
</AddTag>
