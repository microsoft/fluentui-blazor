@using Xunit
@using Microsoft.FluentUI.AspNetCore.Components
@inherits FluentUITestContext

@code {
    public FluentNavSectionHeaderTests()
    {
        JSInterop.Mode = JSRuntimeMode.Loose;
        Services.AddFluentUIComponents();
    }

    [Fact]
    public void FluentNavSectionHeader_Renders_With_Title()
    {
        // Arrange & Act
        var cut = Render(@<FluentNav>
            <FluentNavSectionHeader Title="My Section" />
        </FluentNav>);

        // Assert
        Assert.NotNull(cut);
        Assert.Contains("My Section", cut.Markup);
        Assert.Contains("fluent-navsectionheader", cut.Markup);
        Assert.Contains("<h3", cut.Markup);
    }

    [Fact]
    public void FluentNavSectionHeader_Renders_Empty_When_No_Title()
    {
        // Arrange & Act
        var cut = Render(@<FluentNav>
            <FluentNavSectionHeader Title="" />
        </FluentNav>);

        // Assert
        Assert.NotNull(cut);
        Assert.Contains("fluent-navsectionheader", cut.Markup);
    }

    [Fact]
    public void FluentNavSectionHeader_Throws_When_Not_Child_Of_Nav()
    {
		// Arrange - Create a derived FluentNav (which should fail the exact type check)
		var derivedNav = new DerivedFluentNav(Services.GetRequiredService<LibraryConfiguration>());

        // Arrange & Act & Assert
        var ex = Assert.Throws<InvalidOperationException>(() =>
        {
            Render(@<CascadingValue Value="derivedNav"><FluentNavSectionHeader Title="My Section" /></CascadingValue>);
        });

        Assert.Contains("can only be used as a direct child of", ex.Message);
        Assert.Contains("FluentNav", ex.Message);
    }
}
